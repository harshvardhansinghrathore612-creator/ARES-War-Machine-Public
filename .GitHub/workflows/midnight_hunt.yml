name: ARES V3 God Mode Hunter
on:
  schedule:
    - cron: '0 0 * * *' # Auto-starts at Midnight
  workflow_dispatch: # Allows manual start

jobs:
  hunt:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4
        
      - name: Maximize Disk Space
        run: |
          sudo rm -rf /usr/share/dotnet /usr/local/lib/android /opt/ghc
          sudo apt-get update && sudo apt-get install -y zip jq curl

      - name: Install reconFTW (Ultimate Edition)
        run: |
          git clone --depth 1 https://github.com/six2dez/reconftw
          cd reconftw/ && ./install.sh -y
          
      - name: Execute Full Attack Suite
        env:
          TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
          # Using your custom secret name here
          GITHUB_TOKEN: ${{ secrets.GIT_PAT }} 
        run: |
          TARGET=$(cat targets.txt)
          cd reconftw/
          
          # We export the token so reconFTW tools (like Subfinder) can use it
          export GITHUB_TOKEN=${{ secrets.GIT_PAT }}
          
          # -r: Full Recon | -a: Active Attacks | -s: Screenshots | --deep: God Mode
          ./reconftw.sh -d $TARGET -r -a -s --deep --notifications
          
      - name: Pack & Send Master Report
        if: always()
        env:
          TG_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
          TG_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        run: |
          TARGET=$(cat targets.txt)
          zip -r "ARES_GOD_REPORT_${TARGET}.zip" "reconftw/Recon/$TARGET"
          curl -F document=@"ARES_GOD_REPORT_${TARGET}.zip" \
               "https://api.telegram.org/bot$TG_TOKEN/sendDocument?chat_id=$TG_CHAT_ID&caption=ðŸ”¥ GOD MODE REPORT: $TARGET"
