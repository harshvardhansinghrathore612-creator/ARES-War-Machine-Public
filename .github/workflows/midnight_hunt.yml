name: 'ARES V88 COMPLETE ARSENAL + FORCE FLOW'
on:
  workflow_dispatch: 

jobs:
  hunt:
    runs-on: ubuntu-latest
    timeout-minutes: 360 
    permissions:
      contents: write
      actions: write

    steps:
      - name: 'Checkout Code'
        uses: actions/checkout@v4

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 1: AGGRESSIVE DISK CLEANUP (YOUR ORIGINAL LOGIC)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: 'Auto-Cleanup Previous Data'
        run: |
          echo "=== Cleaning Previous Run Data ==="
          sudo rm -rf reconftw/ 2>/dev/null || true
          sudo rm -rf *.zip ARES_*.zip FINAL_*.zip BURST_*.zip PART.* FINAL_PART_* 2>/dev/null || true
          sudo rm -rf Sent_Buffer/ .sent_bytes 2>/dev/null || true
          go clean -cache -modcache -testcache 2>/dev/null || true
          pip cache purge 2>/dev/null || true
          
          echo "=== System Bloat Removal ==="
          sudo rm -rf /usr/share/dotnet /usr/local/lib/android /opt/ghc /usr/local/go /opt/az /opt/hostedtoolcache
          sudo rm -rf /usr/share/swift /usr/local/.ghcup /usr/lib/jvm
          sudo apt-get clean
          sudo apt-get autoclean
          sudo apt-get autoremove -y
          df -h /

      - name: 'System Initialization & Telegram Alert'
        run: |
          TARGET=$(grep -v '^#' targets.txt | tr -d '\r' | xargs | awk '{print $1}')
          curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage" \
            -d "chat_id=${{ secrets.TELEGRAM_CHAT_ID }}" \
            -d "text=ğŸš€ [ARES V88] FORCE FLOW ARSENAL%0Aâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”%0AğŸ¯ Target: $TARGET%0Aâš¡ Status: Bypassing [30/30] Hang%0AğŸ”§ Tools: 94+ (FULL CONFIG)%0AğŸ§¹ Storage: CLEARED"

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 2: GO ENVIRONMENT SETUP (YOUR ORIGINAL LOGIC)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: 'Force Go Installation'
        run: |
          wget -q https://go.dev/dl/go1.22.0.linux-amd64.tar.gz
          sudo tar -C /usr/local -xzf go1.22.0.linux-amd64.tar.gz
          rm go1.22.0.linux-amd64.tar.gz
          echo "/usr/local/go/bin" >> $GITHUB_PATH
          echo "/home/runner/go/bin" >> $GITHUB_PATH
          echo "/home/runner/.local/bin" >> $GITHUB_PATH
          echo "GOROOT=/usr/local/go" >> $GITHUB_ENV
          echo "GOPATH=/home/runner/go" >> $GITHUB_ENV

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 3: SYSTEM DEPENDENCIES (YOUR ORIGINAL LOGIC)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: 'Install Dependencies'
        run: |
          export DEBIAN_FRONTEND=noninteractive
          sudo apt-get update -qq
          sudo apt-get install -y -qq libpcap-dev libcurl4-openssl-dev libxml2-dev libxslt1-dev \
            python3-pip python3-dev python3-venv zip pipx bc rsync jq chromium-browser \
            build-essential ruby ruby-dev git wget curl unzip

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 4: RECONFTW LIVE INSTALL (FORCE FLOW FIX)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: 'Install reconFTW Without Testing'
        run: |
          TARGET=$(grep -v '^#' targets.txt | tr -d '\r' | xargs | awk '{print $1}')
          export PATH="/usr/local/go/bin:/home/runner/go/bin:/home/runner/.local/bin:$PATH"
          git clone --depth 1 https://github.com/six2dez/reconftw
          cd reconftw/
          
          # Rip out testing logic before install
          sed -i '/printf "${bgreen}#######%0A/,/printf.*test scan/d' install.sh
          sed -i '/subfinder.*-d.*\.y/d' install.sh
          sed -i '/assetfinder.*\.y/d' install.sh
          sed -i '/amass.*enum.*-d.*\.y/d' install.sh
          sed -i '/nuclei.*-u.*http/d' install.sh
          sed -i '/httpx.*-u.*http/d' install.sh
          sed -i '/katana.*-u.*http/d' install.sh
          sed -i '/gau.*\.y/d' install.sh
          
          pipx ensurepath --force
          
          export DEBIAN_FRONTEND=noninteractive
          # ğŸ”¥ THE FIX: Use bash -x to see the hang and EOF to bypass hidden prompts
          bash -x ./install.sh <<EOF
          y
          y
          y
          EOF
          
          curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendMessage" \
            -d "chat_id=${{ secrets.TELEGRAM_CHAT_ID }}" \
            -d "text=âœ… INSTALLATION COMPLETE%0Aâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”%0AğŸ¯ Target: $TARGET%0AğŸ› ï¸ 94+ Tools Welded%0AğŸ”¥ Starting Deep Scan now..."

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 5: COMPLETE 94+ TOOL CONFIGURATION (YOUR FULL LIST)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: 'Configure All Tools'
        env:
          GIT_PAT: ${{ secrets.GIT_PAT }}
        run: |
          cd reconftw/
          # CORE FEATURES
          sed -i 's/DEEP=false/DEEP=true/g' reconftw.cfg
          sed -i 's/MULTITHREADING=false/MULTITHREADING=true/g' reconftw.cfg
          
          # SUBDOMAIN ENUM (15+ tools)
          sed -i 's/SUBCRT=false/SUBCRT=true/g' reconftw.cfg
          sed -i 's/SUBANALYTICS=false/SUBANALYTICS=true/g' reconftw.cfg
          sed -i 's/SUBBRUTE=false/SUBBRUTE=true/g' reconftw.cfg
          sed -i 's/SUBSCRAPING=false/SUBSCRAPING=true/g' reconftw.cfg
          sed -i 's/SUBPERMUTE=false/SUBPERMUTE=true/g' reconftw.cfg
          sed -i 's/SUBREGEX=false/SUBREGEX=true/g' reconftw.cfg
          sed -i 's/ZONETRANSFER=false/ZONETRANSFER=true/g' reconftw.cfg
          
          # PASSIVE & OSINT
          sed -i 's/PASSIVE=false/PASSIVE=true/g' reconftw.cfg
          sed -i 's/WAYBACK=false/WAYBACK=true/g' reconftw.cfg
          sed -i 's/GITHUB=false/GITHUB=true/g' reconftw.cfg
          sed -i 's/OSINT=false/OSINT=true/g' reconftw.cfg
          sed -i 's/EMAILS=false/EMAILS=true/g' reconftw.cfg
          
          # WEB PROBING - DISABLED PER REQUEST
          sed -i 's/WEBPROBESIMPLE=true/WEBPROBESIMPLE=false/g' reconftw.cfg
          sed -i 's/WEBPROBEFULL=true/WEBPROBEFULL=false/g' reconftw.cfg
          
          # VULNS & FUZZING (40+ tools)
          sed -i 's/NUCLEICHECK=false/NUCLEICHECK=true/g' reconftw.cfg
          sed -i 's/VULNS_GENERAL=false/VULNS_GENERAL=true/g' reconftw.cfg
          sed -i 's/XSS=false/XSS=true/g' reconftw.cfg
          sed -i 's/CORS=false/CORS=true/g' reconftw.cfg
          sed -i 's/SSRF_CHECKS=false/SSRF_CHECKS=true/g' reconftw.cfg
          sed -i 's/SQLI=false/SQLI=true/g' reconftw.cfg
          sed -i 's/FUZZ=false/FUZZ=true/g' reconftw.cfg
          sed -i 's/FUZZPARAMS=false/FUZZPARAMS=true/g' reconftw.cfg
          
          # CLOUD & S3
          sed -i 's/S3BUCKETS=false/S3BUCKETS=true/g' reconftw.cfg
          sed -i 's/CLOUD_IP=false/CLOUD_IP=true/g' reconftw.cfg
          
          # EXPLOITATION & TAKEOVER
          sed -i 's/TAKEOVER=false/TAKEOVER=true/g' reconftw.cfg
          sed -i 's/DNSTAKEOVER=false/DNSTAKEOVER=true/g' reconftw.cfg

          # DISABLE ONLY API-DEPENDENT TOOLS
          sed -i 's/VIRUSTOTAL=true/VIRUSTOTAL=false/g' reconftw.cfg
          sed -i 's/SHODAN=true/SHODAN=false/g' reconftw.cfg
          
          mkdir -p /home/runner/Tools
          echo "$GIT_PAT" > /home/runner/Tools/.github_tokens

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 6: SYSTEM BINARY WELD (YOUR ORIGINAL LOGIC)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: 'System Binary Weld'
        run: |
          sudo ln -sf /usr/local/go/bin/* /usr/bin/ 2>/dev/null || true
          sudo ln -sf /home/runner/go/bin/* /usr/bin/ 2>/dev/null || true
          sudo ln -sf /home/runner/.local/bin/* /usr/bin/ 2>/dev/null || true
          sudo find /home/runner/Tools -type f -executable -exec ln -sf {} /usr/bin/ \; 2>/dev/null || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 7: EXECUTION (YOUR ORIGINAL LOGIC)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: 'Execute Full Reconnaissance'
        timeout-minutes: 320
        run: |
          TARGET=$(grep -v '^#' targets.txt | tr -d '\r' | xargs | awk '{print $1}')
          export PATH="/usr/local/go/bin:/home/runner/go/bin:/home/runner/.local/bin:/usr/bin:/bin:$PATH"
          export TELEGRAM_TOKEN="${{ secrets.TELEGRAM_TOKEN }}"
          export TELEGRAM_CHAT_ID="${{ secrets.TELEGRAM_CHAT_ID }}"
          RECON_DIR="${GITHUB_WORKSPACE}/reconftw/Recon/${TARGET}"
          SENT_MARKER="${GITHUB_WORKSPACE}/.sent_bytes"
          echo "0" > "$SENT_MARKER"
          
          (
            while true; do
              sleep 120
              if [ -d "$RECON_DIR" ]; then
                CURRENT_SIZE=$(du -sb "$RECON_DIR" | awk '{print $1}')
                SENT_SIZE=$(cat "$SENT_MARKER")
                if [ $((CURRENT_SIZE - SENT_SIZE)) -ge 47185920 ]; then
                  TIMESTAMP=$(date +%Y%m%d_%H%M)
                  sudo find "$RECON_DIR" -type f -newer "$SENT_MARKER" -print0 | sudo xargs -0 zip -q "ARES_BURST_${TIMESTAMP}.zip" || true
                  curl -F chat_id="${TELEGRAM_CHAT_ID}" -F document=@"ARES_BURST_${TIMESTAMP}.zip" -F caption="ğŸ“¦ BURST: New Findings for ${TARGET}" "https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendDocument"
                  echo "$CURRENT_SIZE" > "$SENT_MARKER"
                  rm "ARES_BURST_${TIMESTAMP}.zip"
                fi
              fi
            done
          ) &
          SENDER_PID=$!
          
          cd reconftw/
          sudo -E PATH="$PATH" TELEGRAM_TOKEN="${TELEGRAM_TOKEN}" TELEGRAM_CHAT_ID="${TELEGRAM_CHAT_ID}" ./reconftw.sh -d "${TARGET}" -r -a -s --deep
          kill $SENDER_PID 2>/dev/null || true

      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      # PHASE 8: FINAL DELIVERY & CLEANUP (YOUR ORIGINAL LOGIC)
      # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
      - name: 'Final Report Delivery & Cleanup'
        if: always()
        run: |
          TARGET=$(grep -v '^#' targets.txt | tr -d '\r' | xargs | awk '{print $1}')
          RECON_DIR="reconftw/Recon/${TARGET}"
          if [ -d "$RECON_DIR" ]; then
            sudo zip -r "FINAL_REPORT.zip" "$RECON_DIR" || true
            split -b 45M "FINAL_REPORT.zip" "FINAL_PART_"
            for part in FINAL_PART_*; do
              curl -F chat_id="${{ secrets.TELEGRAM_CHAT_ID }}" -F document=@"${part}" "https://api.telegram.org/bot${{ secrets.TELEGRAM_TOKEN }}/sendDocument"
              rm "$part"
            done
          fi
          sudo rm -rf reconftw/ /home/runner/Tools/* /tmp/* 2>/dev/null || true
